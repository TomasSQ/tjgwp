<?xml version="1.0" encoding="UTF-8"?>
<engine>
	<dot>
		<div class="books-list padding clearfix">
		{{? it.books}}
		{{? it.books.length}}
		{{~it.books :book}}
			<div class="book" data-book-id="{{=book.id}}">
				<div class="book-cape">
				{{? book.capeImageUrl}}
					<img class="book-cape-url" src="" title="{{=book.title}}"></img>
				{{??}}
					<div data-no-animation="true">{{=book.title}}</div>
				{{?}}
				</div>
				<div class="buttons">
					<input type="file" name="bookCape" data-url="{{=book.uploadUrl}}" data-message="{{=i18n('cape')}}"/>
				</div>
				{{? book.capeImageUrl}}
				<div class="book-title">{{=book.title}}</div>
				{{?}}
				<div class="book-details padding">
					{{=utils.text({text : book.chaptersCount, suffix : 'chapter', noValue : 'no-chapters', plural : true, i18n : true})}}
				</div>
			</div>
		{{~}}
		{{?}}
		{{??}}
			<span>{{=i18n('no-books')}}</span>
		{{?}}
		</div>
	</dot>
	<script>
		if (context.books && context.books.length > 0)
			for (var i = 0; context.books.length > i; i++)
				container.find('[data-book-id="' + context.books[i].id + '"] img').attr('src', context.books[i].capeImageUrl);

		container.find('.book .book-cape div').fitText();
	</script>
</engine>